# Javascript 第十天

## 一、DOM 基础

### 1.1 对应与排它

我们一般习惯用一个元素去控制其它元素。根据它们之间的联系（索引值相同）进行书写。

​	排他：选中的元素改变其它元素，让其它元素变成原状。

根据这一思想我们可以实现一些交互功能，如：选项卡的实现。

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .app {
            border: 1px solid #000;
            display: inline-block;
        }
        .app .header {
            line-height: 36px;
        }
        .app .header span {
            padding: 0 10px;
            font-size: 18px;
        }
        .app .header span.choose {
            color: #f30;
        }
        .app .body {
            height: 150px;
            padding: 10px;
        }
        .app .body p {
            display: none;
        }
        .app .body p.choose {
            display: block;
        }
    </style>
</head>
<body> 
    <div id="app" class="app">
        <!-- 默认选中第一个 -->
        <div class="header">
            <span class="choose">精选</span>
            <span>社会</span>
            <span>娱乐</span>
            <span>体育</span>
        </div>
        <div class="body">
            <p class="choose">精选新闻内容</p>
            <p>社会新闻内容</p>
            <p>娱乐新闻内容</p>
            <p>体育新闻内容</p>
        </div>
    </div>
<script>
// 获取元素
var app = document.getElementById('app');
// 获取span
var spans = app.getElementsByTagName('span');
// 后去p
var ps = app.getElementsByTagName('p');
// 绑定事件
for (var i = 0, len = spans.length; i < len; i++) {
    // 设置索引值
    spans[i].index = i;
    // 绑定事件
    spans[i].onclick = function() {
        // 排它法设置样式
        // 清除所有
        for (var j = 0; j < len; j++) {
            // 清除每一个span的类
            spans[j].className = '';
        }
        // 设置被点击的span的类
        spans[this.index].className = 'choose';
        // 对p使用排它
        for (var k = 0, klen = ps.length; k < klen; k++) {
            // 清除所有p的类
            ps[k].className = '';
        }
        // 设置特殊的：对应法
        ps[this.index].className = 'choose';
    }
}
</script>
</body>
</html>
```



### 1.2 样式计算

计算后的样式：指的是HTML元素在css各种选择器综合作用下，得到的最终样式。

高级浏览器的方法：window.getComputedStyle()，该方法接收一个要进行样式计算的元素，并返回一个可以进行属性查询的接口。返回接口提

供了一个名为getPropertyValue()的方法，用于检索特定样式属性的计算样式。getPropertyValue方法接收css属性名称，而不是驼峰式的名称。

getPropertyValue()可以不写，直接用方括号来检索属性也可以。

​	getComputedStyle：得到的样式是一个对象，包含了所有css样式。是window对象的方法

​		注：也可以直接使用[]继续得到具体的计算后的属性值。（中括号中可以使用驼峰也可以使用短横）

​	getPropertyValue：得到的是具体的某一个属性的值。参数和css书写一样，不能使用驼峰

IE6,7,8方法

​	低版本浏览器不认识getComputedStyle。IE低版本计算后的方法，currentStyle.(对象打点调用currentStyle,继续打点调用具体的某个计算后

的样式属性)。currentStyle也可以直接使用[]得到计算后的样式属性。注意：不管是中括号还是点语法都只能用驼峰命名法。(使用方法和style非

常类似)

### 1.3 能力检测

不管是低版本还是高级浏览器都可以正常输出计算后的样式。需要进行能力检测（就是判断认不认识window.getComoutedStyle）

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #app {
            font-size: 40px;
            width: 200px;
            height: 200px;
            background-color: green;
            border-bottom-color: #000;
            border-bottom-width: 20px;
            border-bottom-style: solid;
        }
    </style>
</head>
<body>
    <div id="app" style="color: red;">
        hello
    </div>
<script>

/***
 * 封装一个getStyle方法，可以在不同浏览器下获取样式
 * @obj         元素对象
 * @key         属性名称
 * return       获取的样式
 **/
function getStyle(obj, key) {
    // 能力检测：判断浏览器的能力，能做什么就做什么
    // 浏览器是否支持getComponent方法，支持就使用
    if (window.getComputedStyle) {
        // 通过该方法获取
        // 已经确定了该方法存在，就可以直接使用了
        // 方法一
        return getComputedStyle(obj)[key];
        // 方法二
        // 将key转成横杠法      borderLeftColor => border-left-color
        // key = key.replace(/([A-Z])/g, function(match, $1) {
        //     // 返回的是
        //     return '-' + $1.toLowerCase();
        // })
        // return getComputedStyle(obj).getPropertyValue(key);
    } else {
        var style = obj.currentStyle;
        // 如果有样式，可以获取
        if (style) {
            // 将横杠法转成驼峰式命名法    border-left-color => borderLeftColor
            key = key.replace(/-([a-z])?/g, function(match, $1) {
                return $1.toUpperCase();
            })
            // 返回样式
            return style[key]
        } else {
            // 没有样式，要提示
            alert('你的浏览器不支持获取计算样式功能。')
        }
    }
}

// 测试
// 获取元素
var app = document.getElementById('app');
alert(getStyle(app, 'color'));
alert(getStyle(app, 'fontSize'));
alert(getStyle(app, 'font-size'));

// function demo() {

// }
// console.log(demo)
// console.log(window.demo)

</script>
</body>
</html>
```



## 二、jQuery

### 2.1 jquery 历史

官网：www.jquery.com

logo和slogan（口号）： 写更少的代码，做更多的事情。

官网的自我介绍：

​	jQuery is a fast, small, and feature-rich JavaScript library. 

​	jQuery是一个快速、小巧的、特点众多的JavaScript库。

​	It makes things like HTML document traversal and manipulation, event handling, animation, and Ajax much simpler with an easy-to-

use API that works across a multitude of browsers. 

​	它用自己非常方便的跨浏览器API，使得诸如文档遍历、文档操作、事件监听、动画、和Ajax变得更简单。

​	With a combination of versatility and extensibility, jQuery has changed the way that millions of people write JavaScript.

​	通过把多用途和高拓展性结合起来，jQuery改变了无数程序员书写JavaScript程序的方式。

jQuery的版本问题：

​	jQuery的最新版本是3.2.1，不兼容IE6、7、8的。

​	我们学习的是jQuery1.12.3，兼容IE6、7、8的，更符合中国的实际情况。

​	jQuery3和jQuery1.12.3的API完全一样。

### 2.2 使用 jQuery

jQuery的哲学是什么：简化DOM开发，为兼容而生！

​	jQuery简化了我们对DOM的开发，所以我们就有更多的精力，着眼于业务的书写。所以，从jQuery课程开始，我们要练习写业务！写可靠的

业务！代码量就要多起来了！

jquery引包

​	jquery是javascript的一个实用库， 如果想要使用该文件，必须引入jquery才能使用里面各种各样的方法，引入jquery的时候需要注意，引入

jquery的script标签要写在最前面。

### 2.3 体会 jQuery

简化获取元素的方式

简化元素的运动

jquery操作都是匹配的，不管是更改样式还是添加事件。以后几乎不会用到for循环

都是兼容IE的不用再进行能力检测了。并且都是得到的是计算后的样式。

jquery简化了DOM操作，比如添加，删除，更改节点。

### 2.4 $()

jquery是一个js语言书写一个js库。全局只向外暴露了一个$()函数。接收的是css选择器的参数。返回的是一个jquery对象（是一个类数组对

象）。jquery对象具有很多jquery对象的方法。

​	谁的方法谁调用:

​		js对象 → jquery对象  直接加$()

​		jquery对象 → js对象  直接书写索引值

选择器

​	$()中接收css选择器。接收的是字符串（css选择器如何书写，参数如何书写）。

​		支持css2.1选择器，也支持css3选择器:

​	eq()还可以提取出一种方法.eq()。

 jQuery函数：jQuery文件全局其实是向外暴露的是jQuery函数，只是人们觉得书写jQuery()函数比较复杂，后来改为$()。现在仍然保留着

jQuery()

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div></div>
    <h1>hello</h1>
    <div class="container">
        <p>1</p>
        <p>2</p>
        <p>3</p>
        <p class="demo">4</p>
    </div>
    <h2 class="demo"></h2>
    <div id="app"></div>
    <div color="red"></div>
<!-- 引入jq -->
<script src="./jquery.js"></script>
<script>
// // 通过$方法获取div
// var div = $('div');
// // div.html('hello')
// // 我们一定要区分开jquery对象和js对象
// // jquery对象只能使用jquery方法
// // js对象不能使用jqiuery方法

// // jq对象转成js对象
// // jq对象是类数组对象，通过下标可以获取js对象
// div[0].innerHTML = 'abc'
// console.log(div[0])

// jquery支持css2.1以及css3的选择器
// console.log($('div'));
// console.log($('#app'));
// console.log($('.demo'));
// // 组合形式
// console.log($('h2.demo'));
// console.log($('[color=red]'));
// console.log($('.container p:first-child'));
// console.log($('p:first'));
// console.log($('p:last'));
// // 从0开始计数
// console.log($('p:even'));

// 二次筛选
// console.log($('div').eq(1))
// console.log(jQuery('div').eq(1))

// 获取将window转成jquery
// 转成jquery对象后，就可以使用jquery的一些方法了
console.log($(window))
console.log($(document))
console.log($(function() {}))
console.log($([]))
console.log($({}))
console.log($(''))

</script>
</body>
</html>
```



### 2.5 常用方法

size()：length属性。通过$()函数获取到的jquery对象也具有length。size() 和 length 都表示元素的个数。

操作样式：css()方法得到的是元素对象计算后的样式。

​	读取：参数是css属性名。（短横驼峰都可以）返回的是第一个元素的样式，如果想让得到后的值参与运算，需要转为number类型。

parseInt()，parseFloat（）

​	设置：可以设置一个属性。还可以同时设置多个属性。建议驼峰式命名，（像素单位可以省略）

​	总结：jquery中的一些方法，可以获取数据，可以设置数据（函数重载）

绑定事件：on方法或者直接事件名称定义回调函数

显隐方法：show()和hide()，

​	show()出现。终点状态display:block

​	hide()消失。终点状态display:none。

​		参数：不书写参数，表示干嘣效果。还可以书写参数，表示动画完成的时间。单位ms省略不写单位。

​	toggle()：切换

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        div {
            height: 80px;
            border-right: 10px solid #f30;
        }
        div:first-child {
            border-right-color: gold;
        }
    </style>
</head>
<body>
    <div>1</div>
    <div>2</div>
    <div>3</div>
    <div>4</div>
<script src="./jquery.js"></script>
<script>
// 获取元素
// 工作中，我们常常将jQuery获取的元素存储在一个变量中，让$方法执行一次，后面就可以多次使用了
var divs = $('div');
// console.log(divs.length)
// console.log(divs.size())
// 设置样式
divs.css('font-size', '50px')
divs.css('borderBottom', '1px solid green')
// 设置多个属性
divs.css({
    backgroundColor: 'pink',
    // 像素单位可以省略
    width: 400
})
// 获取样式
// 第一个元素的样式
// console.log(divs.css('border-right'))
// console.log(divs.css('borderRight'))
// console.log(divs.css('height'))
// 想运算要转成字符串
// console.log(parseInt(divs.css('height')) + 20)

// 绑定事件
// divs.on('click', function() {
//     // this指向当前的元素
//     // console.log(this)
//     // this是js中的dom对象，因此要使用源生的方式操作
//     // this.style.backgroundColor = 'skyblue'
//     // 想使用jquery方式要转成jquery对象
//     // 工作中，建议转成jq对象，因为兼容性更好，使用更方便
//     $(this).css('backgroundColor', 'yellowgreen')
// })
// 事件简写
// 给函数传递的方法，我们称之为回调
divs.click(function() {
    // 跟on方法一样，会对所有获取的元素绑定事件
    console.log(this)
})
</script>
</body>
</html>
```

